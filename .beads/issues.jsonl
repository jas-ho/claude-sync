{"id":"claude-sync-3ha","title":"Git Tracking for Sync Output","description":"Add automatic git tracking to the sync output directory for easy recovery and change history.\n\n## Goal\nMake synced data recoverable even if accidentally overwritten, and provide change history without needing to push to GitHub (data may be private).\n\n## Approach\n- Auto-initialize git repo in output directory if not exists\n- Auto-commit after each sync with timestamp\n- Local-only (no remote push)\n\n## Benefits\n- Easy recovery: git checkout to restore previous state\n- Change visibility: git diff to see what changed\n- No data loss: even if sync overwrites, history preserved\n\n## Implementation\nAfter sync completes:\n```python\ndef git_track(output_dir: Path):\n    if not (output_dir / '.git').exists():\n        subprocess.run(['git', 'init'], cwd=output_dir)\n        subprocess.run(['git', 'add', '.'], cwd=output_dir)\n        subprocess.run(['git', 'commit', '-m', 'Initial sync'], cwd=output_dir)\n    else:\n        subprocess.run(['git', 'add', '.'], cwd=output_dir)\n        # Only commit if changes exist\n        result = subprocess.run(['git', 'diff', '--staged', '--quiet'], cwd=output_dir)\n        if result.returncode != 0:\n            subprocess.run(['git', 'commit', '-m', f'Sync {datetime.now().isoformat()}'], cwd=output_dir)\n```\n\n## CLI Flag\n- --no-git: Disable git tracking (for testing or special cases)\n\n## Dependencies\n- Requires MVP complete","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-07T13:15:14.957464+01:00","updated_at":"2025-12-07T13:15:14.957464+01:00","dependencies":[{"issue_id":"claude-sync-3ha","depends_on_id":"claude-sync-8co","type":"blocks","created_at":"2025-12-07T13:15:14.958891+01:00","created_by":"jason"}]}
{"id":"claude-sync-3ha.1","title":"Implement auto git-init and commit","description":"Add git initialization and auto-commit:\n\n## Logic\n1. After sync completes, check if output_dir/.git exists\n2. If not, run git init\n3. Stage all files (git add .)\n4. Commit with descriptive message\n\n## Commit Message Format\n- Initial: 'Initial sync from claude.ai'\n- Updates: 'Sync update YYYY-MM-DD HH:MM:SS'\n\n## Only Commit if Changes\nCheck for staged changes before committing:\n```bash\ngit diff --staged --quiet\n# Exit code 0 = no changes, 1 = changes exist\n```\n\n## Error Handling\n- Git not installed: warn but don't fail\n- Permission errors: warn but don't fail\n- This is a convenience feature, not critical path","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-07T13:15:29.108845+01:00","updated_at":"2025-12-07T13:15:29.108845+01:00","dependencies":[{"issue_id":"claude-sync-3ha.1","depends_on_id":"claude-sync-3ha","type":"parent-child","created_at":"2025-12-07T13:15:29.109714+01:00","created_by":"jason"}]}
{"id":"claude-sync-3ha.2","title":"Add --no-git flag and test recovery workflow","description":"Add CLI flag to disable git tracking and test the recovery workflow:\n\n## CLI Addition\n--no-git: Skip git init/commit (useful for testing or if git not wanted)\n\n## Test Recovery Workflow\n1. Run initial sync\n2. Manually modify a CLAUDE.md file\n3. Run sync again (overwrites)\n4. Use git checkout to restore manual changes\n5. Document this in README\n\n## Verify\n- [ ] --no-git prevents any git operations\n- [ ] Recovery workflow works as expected\n- [ ] git log shows meaningful commit history","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-07T13:15:42.203037+01:00","updated_at":"2025-12-07T13:15:42.203037+01:00","dependencies":[{"issue_id":"claude-sync-3ha.2","depends_on_id":"claude-sync-3ha","type":"parent-child","created_at":"2025-12-07T13:15:42.20358+01:00","created_by":"jason"}]}
{"id":"claude-sync-3iq","title":"Sync standalone conversations (outside projects)","description":"Add support for syncing conversations that are not associated with any project.\n\n## Scope\nConversations created outside of projects (general Claude chats).\n\n## API Endpoint\n- GET /api/organizations/{org}/chat_conversations - All conversations\n- Filter out those already synced via projects\n\n## Output Structure\n```\n\u003coutput-dir\u003e/\n├── index.json\n├── \u003cproject-folders\u003e/\n└── _standalone/              # Special folder for non-project conversations\n    ├── index.json\n    └── \u003cconv-slug\u003e-\u003cuuid\u003e.json\n```\n\n## Considerations\n- May be many conversations (600+ in sample data)\n- Less organized than project conversations\n- Lower priority - project conversations are more valuable\n\n## CLI Flag\n--include-standalone: Include standalone conversations (off by default)\n\n## Dependencies\nRequires project-associated conversation sync working first.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-07T13:31:28.805592+01:00","updated_at":"2025-12-07T13:31:28.805592+01:00","dependencies":[{"issue_id":"claude-sync-3iq","depends_on_id":"claude-sync-8co.11","type":"blocks","created_at":"2025-12-07T13:31:28.806771+01:00","created_by":"jason"}]}
{"id":"claude-sync-84p","title":"Documentation and Claude Code Integration","description":"Create comprehensive documentation and Claude Code integration helpers.\n\n## Goal\nMake the tool easy to use for anyone, with clear instructions for Claude Code integration.\n\n## Deliverables\n1. README.md with:\n   - Quick start guide\n   - How to find your org UUID\n   - Output structure explanation\n   - Claude Code integration instructions\n\n2. .claude/commands/setup-sync.md\n   - Idempotent setup command\n   - Helps user configure CLAUDE.md imports\n   - Can be run multiple times safely\n\n## Integration Pattern\nUser adds to their ~/.claude/CLAUDE.md:\n```markdown\n# Synced Web App Projects\n@~/.claude/synced-projects/project-a/CLAUDE.md\n@~/.claude/synced-projects/project-b/CLAUDE.md\n```\n\n## User-Agnostic\n- No hardcoded paths in docs\n- Use ~ or environment variables\n- Works on Mac/Linux (Windows is stretch goal)","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-07T13:16:56.706093+01:00","updated_at":"2025-12-07T13:16:56.706093+01:00","dependencies":[{"issue_id":"claude-sync-84p","depends_on_id":"claude-sync-8co","type":"blocks","created_at":"2025-12-07T13:16:56.707319+01:00","created_by":"jason"},{"issue_id":"claude-sync-84p","depends_on_id":"claude-sync-bkw","type":"blocks","created_at":"2025-12-07T13:16:56.708248+01:00","created_by":"jason"}]}
{"id":"claude-sync-84p.1","title":"Write README.md","description":"Create comprehensive README:\n\n## Sections\n1. **Overview** - What this tool does\n2. **Quick Start** - 3-step guide\n3. **Installation** - Just download the script\n4. **Finding Your Org UUID** - With screenshots/steps\n5. **Usage Examples** - Common commands\n6. **Output Structure** - What gets created where\n7. **Claude Code Integration** - How to use synced content\n8. **Configuration** - All CLI flags\n9. **Troubleshooting** - Common issues\n\n## Key Points\n- Emphasize single-file, no install needed\n- Show how to make script executable\n- Explain the default output location\n- Link to gist for updates","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-07T13:17:09.589095+01:00","updated_at":"2025-12-07T13:17:09.589095+01:00","dependencies":[{"issue_id":"claude-sync-84p.1","depends_on_id":"claude-sync-84p","type":"parent-child","created_at":"2025-12-07T13:17:09.589744+01:00","created_by":"jason"}]}
{"id":"claude-sync-84p.2","title":"Create /setup-sync command","description":"Create a Claude Code slash command to help users integrate synced projects:\n\n## File: .claude/commands/setup-sync.md\n\n## What It Does\n1. Check if synced projects exist at default location\n2. List available projects\n3. Offer to add @imports to user's CLAUDE.md\n4. Idempotent - safe to run multiple times\n\n## Prompt Content\n```markdown\nHelp the user integrate their synced Claude web app projects with Claude Code.\n\n1. Check if ~/.claude/synced-projects/ exists\n2. If yes, list the projects found\n3. Suggest adding imports to ~/.claude/CLAUDE.md like:\n   @~/.claude/synced-projects/project-name/CLAUDE.md\n4. If already integrated, confirm everything looks good\n\nBe helpful and explain what each step does.\n```\n\n## Idempotent Behavior\n- Check if imports already exist before adding\n- Don't duplicate imports\n- Inform user of current state","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-07T13:17:23.643139+01:00","updated_at":"2025-12-07T13:17:23.643139+01:00","dependencies":[{"issue_id":"claude-sync-84p.2","depends_on_id":"claude-sync-84p","type":"parent-child","created_at":"2025-12-07T13:17:23.643766+01:00","created_by":"jason"}]}
{"id":"claude-sync-8co","title":"MVP: Fetch \u0026 Organize","description":"Core functionality to fetch Claude web app projects and organize them into a local directory structure suitable for Claude Code integration.\n\n## Goal\nGet web app project content into Claude Code-friendly local structure with a single command.\n\n## Output Structure\n```\n\u003coutput-dir\u003e/\n├── index.json              # Manifest with sync metadata\n└── \u003cproject-slug\u003e/\n    ├── CLAUDE.md           # From prompt_template\n    ├── meta.json           # Project metadata\n    └── docs/               # Project documents\n```\n\n## Key Requirements\n- Single UV script with inline dependencies\n- Browser cookie extraction (Edge/Chrome via browser-cookie3)\n- Configurable output directory (default: ~/.claude/synced-projects/)\n- Robust filename sanitization (cross-platform)\n- User-agnostic (no hardcoded paths)\n- Progress display with tqdm\n\n## API Endpoints Used\n- GET /api/organizations/{org}/projects\n- GET /api/organizations/{org}/projects/{pid}\n- GET /api/organizations/{org}/projects/{pid}/docs?tree=true\n\n## Gotchas to Watch For\n- Forward slashes in doc titles break filenames\n- Session keys expire frequently\n- Need to handle all invalid filename chars: \u003c\u003e:\"/\\|?*\n- Windows reserved names (CON, PRN, etc.)\n\n## Success Criteria\n- Can run: ./claude_sync.py \u003corg-id\u003e -o \u003coutput-dir\u003e\n- Output is browsable directory structure\n- Project instructions become CLAUDE.md files\n- All docs preserved with safe filenames","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-07T13:12:17.748215+01:00","updated_at":"2025-12-07T13:12:17.748215+01:00"}
{"id":"claude-sync-8co.10","title":"Handle partial sync failures gracefully","description":"Ensure sync failures don't leave corrupted/inconsistent state:\n\n## Problem\nIf sync fails mid-way (network error, session expiry), we could have:\n- Some projects synced, others not\n- Partial project directory (some docs written, others not)\n- index.json inconsistent with actual files\n\n## ⚠️ MEDIUM RISK - Data Consistency\n\n### Strategy: Atomic-ish Writes\n\n**Option A: Write to temp, rename on success**\n```python\ndef sync_project(project, output_dir):\n    temp_dir = output_dir / f'.tmp_{project[\"uuid\"]}'\n    try:\n        # Write all files to temp\n        write_project_to_dir(project, temp_dir)\n        # Atomic rename\n        final_dir = output_dir / slugify(project['name'])\n        if final_dir.exists():\n            shutil.rmtree(final_dir)\n        temp_dir.rename(final_dir)\n    finally:\n        if temp_dir.exists():\n            shutil.rmtree(temp_dir)\n```\n\n**Option B: Track progress, resume on retry (more complex)**\n- Store 'last_successful_project' in index.json\n- On retry, skip already-synced projects\n\n### Recommendation\nStart with Option A (simpler). If sync fails:\n- Partially synced project is cleaned up\n- Successfully synced projects remain\n- User re-runs to complete\n\n### index.json Consistency\nWrite index.json LAST, after all projects synced:\n```python\ndef sync_all(projects, output_dir):\n    results = {}\n    for project in projects:\n        try:\n            sync_project(project, output_dir)\n            results[project['uuid']] = {...}\n        except Exception as e:\n            print(f'Failed to sync {project[\"name\"]}: {e}')\n            # Continue with next project\n    \n    # Write index only with successful projects\n    write_index(output_dir, results)\n```\n\n## Error Reporting\nOn partial failure:\n- List which projects succeeded\n- List which failed with reasons\n- Exit with non-zero code if any failures","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-07T13:21:08.595326+01:00","updated_at":"2025-12-07T13:21:08.595326+01:00","dependencies":[{"issue_id":"claude-sync-8co.10","depends_on_id":"claude-sync-8co","type":"parent-child","created_at":"2025-12-07T13:21:08.595927+01:00","created_by":"jason"}]}
{"id":"claude-sync-8co.11","title":"Sync project-associated conversations","description":"Add conversation syncing for project-associated conversations:\n\n## Scope\nSync conversations that belong to a project (via project UUID association).\n\n## API Endpoint\n- GET /api/organizations/{org}/projects/{pid}/conversations?tree=true - List conversations\n- GET /api/organizations/{org}/chat_conversations/{cid}?rendering_mode=messages\u0026render_all_tools=true - Full conversation\n\n## Output Structure\n```\n\u003cproject-slug\u003e/\n├── CLAUDE.md\n├── meta.json\n├── docs/\n└── conversations/\n    ├── index.json           # Conversation list with metadata\n    └── \u003cconv-slug\u003e-\u003cuuid\u003e.json  # Full conversation\n```\n\n## Conversation JSON Format\n```json\n{\n  \"uuid\": \"...\",\n  \"name\": \"Conversation Title\",\n  \"created_at\": \"...\",\n  \"updated_at\": \"...\",\n  \"messages\": [\n    {\"role\": \"human\", \"text\": \"...\", \"created_at\": \"...\"},\n    {\"role\": \"assistant\", \"text\": \"...\", \"created_at\": \"...\"}\n  ]\n}\n```\n\n## Incremental Sync Support\n- Conversations have updated_at - can detect changes\n- Store last sync timestamp per conversation\n- Only re-fetch if updated_at \u003e last_synced\n\n## CLI Flag\n--skip-conversations: Skip conversation sync (for faster project-only sync)\nDefault: sync conversations\n\n## Performance Note\nMany API calls (1 per conversation). Consider:\n- Progress bar per project showing conversation count\n- Small delay between requests to avoid rate limits","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-07T13:31:14.212424+01:00","updated_at":"2025-12-07T13:31:14.212424+01:00","dependencies":[{"issue_id":"claude-sync-8co.11","depends_on_id":"claude-sync-8co","type":"parent-child","created_at":"2025-12-07T13:31:14.213217+01:00","created_by":"jason"}]}
{"id":"claude-sync-8co.3","title":"Set up script skeleton with UV shebang","description":"Create the initial claude_sync.py with:\n- UV run shebang: #!/usr/bin/env -S uv run --script\n- Inline dependency metadata (script section)\n- Required deps: requests, tqdm, browser-cookie3\n- Basic argparse CLI structure\n- Main function skeleton\n\nReference the gist structure: https://gist.github.com/jas-ho/f95abd89d4e007eac9ee821d7c2a3d0b","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T13:13:29.865749+01:00","updated_at":"2025-12-07T14:00:17.554262+01:00","closed_at":"2025-12-07T14:00:17.554262+01:00","dependencies":[{"issue_id":"claude-sync-8co.3","depends_on_id":"claude-sync-8co","type":"parent-child","created_at":"2025-12-07T13:13:29.866631+01:00","created_by":"jason"}]}
{"id":"claude-sync-8co.4","title":"Implement browser cookie extraction","description":"Implement cookie extraction from browser:\n\n## Requirements\n- Extract sessionKey and cf_clearance cookies from Edge/Chrome\n- Use browser-cookie3 library\n- Support --browser flag (edge/chrome/auto)\n- Clear error message if cookies missing or expired\n\n## Code Pattern (from gist)\n```python\ndef load_cookies(domain: str = 'claude.ai', browser: str = 'edge'):\n    cj = browser_cookie3.edge(domain_name=domain) if browser == 'edge' else browser_cookie3.load(domain_name=domain)\n    need = {'sessionKey', 'cf_clearance'}\n    got = {c.name for c in cj}\n    missing = need - got\n    if missing:\n        sys.exit(f'Missing cookie(s): {missing}. Log into Claude in browser, then rerun.')\n    return cj\n```\n\n## ⚠️ HIGH RISK - Known Issues\n\n### macOS Keychain (Chrome)\nbrowser-cookie3 often fails to access Chrome cookies on macOS due to Keychain permissions.\n**Workaround**: Try Edge first (default), or use --browser chrome with browser fully closed.\n**Fallback**: May need manual cookie extraction instructions in README.\n\n### Browser Must Be Closed\nOn some systems, cookies are locked while browser is open.\n**Mitigation**: Clear error message: 'Close your browser and retry'\n\n### Session Expiration\nsessionKey expires frequently (hours, not days).\n**Mitigation**: \n- Check for 401/403 responses in API client\n- Clear message: 'Session expired. Re-login to Claude.ai and retry'\n\n### Firefox/Safari Not Supported\nbrowser-cookie3 doesn't reliably support these.\n**Mitigation**: Document in README, suggest Edge/Chrome.\n\n### Multiple Profiles\nIf user has multiple browser profiles, may get wrong cookies.\n**Mitigation**: Document which profile needs to be logged in.\n\n## Testing Checklist\n- [ ] Works with Edge on macOS\n- [ ] Works with Chrome on macOS (browser closed)\n- [ ] Clear error if browser open\n- [ ] Clear error if not logged in\n- [ ] Clear error if session expired","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-07T13:13:44.376107+01:00","updated_at":"2025-12-07T14:01:29.813024+01:00","closed_at":"2025-12-07T14:01:29.813024+01:00","dependencies":[{"issue_id":"claude-sync-8co.4","depends_on_id":"claude-sync-8co","type":"parent-child","created_at":"2025-12-07T13:13:44.377067+01:00","created_by":"jason"}]}
{"id":"claude-sync-8co.5","title":"Implement API client for Claude.ai","description":"Implement API client to fetch data from Claude.ai:\n\n## Endpoints\n- GET /api/organizations/{org}/projects - List all projects\n- GET /api/organizations/{org}/projects/{pid} - Project metadata + prompt_template\n- GET /api/organizations/{org}/projects/{pid}/docs?tree=true - Project documents\n\n## Requirements\n- Use requests library with session\n- Set proper headers (User-Agent, Accept, Referer, Origin)\n- Handle 404 (FileNotFoundError) and other HTTP errors gracefully\n- Timeout handling (30s default)\n\n## Headers Pattern\n```python\nHEADERS = {\n    'User-Agent': 'Mozilla/5.0 ...',\n    'Accept': 'application/json, text/plain, */*',\n    'Referer': 'https://claude.ai/',\n    'Origin': 'https://claude.ai',\n}\n```\n\n## ⚠️ MEDIUM RISK - API Instability\n\n### Undocumented API\nThis is Claude's internal web API, not a public API.\n- Endpoints could change without notice\n- Response format could change\n- Could get blocked as bot traffic\n\n**Mitigation**:\n- Use realistic browser User-Agent\n- Add small delays between requests (0.1-0.5s)\n- Handle unexpected response formats gracefully\n- Log raw responses on error for debugging\n\n### Rate Limiting (Unknown)\nNo documentation on rate limits for internal API.\n\n**Mitigation**:\n- Don't parallelize aggressively (unlike gist's MAX_WORKERS=16)\n- Start conservative: sequential requests with small delays\n- Add --parallel flag later if needed\n\n### Session Expiration Mid-Sync\nFor large orgs, session might expire during sync.\n\n**Mitigation**:\n- Check for 401/403 after each request\n- Fail fast with clear message rather than partial corrupt state\n\n## Error Handling\n- 401/403: 'Session expired or invalid. Re-login to Claude.ai'\n- 404: Raise FileNotFoundError (project/doc deleted)\n- 429: 'Rate limited. Wait and retry.' (if we see this)\n- 5xx: 'Claude.ai server error. Try again later.'\n- Timeout: 'Request timed out. Check connection.'\n\n## Retry Logic\nConsider simple retry for transient failures:\n```python\nfor attempt in range(3):\n    try:\n        return fetch(url)\n    except (Timeout, ConnectionError):\n        if attempt == 2: raise\n        time.sleep(1)\n```","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-07T13:13:58.502506+01:00","updated_at":"2025-12-07T13:20:20.792648+01:00","dependencies":[{"issue_id":"claude-sync-8co.5","depends_on_id":"claude-sync-8co","type":"parent-child","created_at":"2025-12-07T13:13:58.503307+01:00","created_by":"jason"}]}
{"id":"claude-sync-8co.6","title":"Implement robust filename sanitization","description":"Implement cross-platform filename sanitization:\n\n## Invalid Characters to Handle\n- Forward slash /\n- Backslash \\\\\n- Colon :\n- Asterisk *\n- Question mark ?\n- Double quotes \"\n- Angle brackets \u003c \u003e\n- Pipe |\n- NULL bytes\n- Control characters (0x00-0x1F)\n\n## Platform-Specific\n- Windows reserved names: CON, PRN, AUX, NUL, COM1-9, LPT1-9\n- Leading/trailing spaces and dots (Windows issue)\n- Max filename length (~255 chars)\n\n## ⚠️ MEDIUM RISK - Collision \u0026 Unicode Issues\n\n### Filename Collisions After Sanitization\nTwo docs: 'Guide: Part 1' and 'Guide/ Part 1' both become 'Guide- Part 1'\n\n**Mitigation**:\n```python\ndef get_unique_filename(base: str, existing: set) -\u003e str:\n    if base not in existing:\n        return base\n    for i in range(1, 1000):\n        candidate = f'{base[:-3]}_{i}.md'\n        if candidate not in existing:\n            return candidate\n    raise ValueError(f'Too many collisions for {base}')\n```\n\n### macOS Case Insensitivity\nHFS+ treats 'Guide.md' and 'guide.md' as same file.\n\n**Mitigation**: \n- Normalize to lowercase for collision checking\n- Or track case-insensitive set of used names\n\n### Unicode Normalization\nmacOS uses NFD, others use NFC. 'é' can be 1 or 2 codepoints.\n\n**Mitigation**:\n```python\nimport unicodedata\nname = unicodedata.normalize('NFC', name)\n```\n\n### Emoji in Filenames\nGenerally works but can cause issues on older systems.\n\n**Mitigation**: Consider stripping or replacing emoji (optional).\n\n## Implementation\n```python\nimport unicodedata\nimport re\n\nINVALID_CHARS = r'[\u003c\u003e:\"/\\\\|?*\\x00-\\x1f]'\nWINDOWS_RESERVED = {'CON', 'PRN', 'AUX', 'NUL'} | {f'{p}{i}' for p in ['COM', 'LPT'] for i in range(1,10)}\n\ndef sanitize_filename(name: str, max_len: int = 200) -\u003e str:\n    # Normalize unicode\n    name = unicodedata.normalize('NFC', name)\n    # Remove/replace invalid chars\n    name = re.sub(INVALID_CHARS, '-', name)\n    # Handle Windows reserved\n    stem = name.rsplit('.', 1)[0].upper()\n    if stem in WINDOWS_RESERVED:\n        name = f'_{name}'\n    # Strip leading/trailing spaces and dots\n    name = name.strip(' .')\n    # Truncate\n    if len(name) \u003e max_len:\n        name = name[:max_len-10] + '_' + hashlib.md5(name.encode()).hexdigest()[:8]\n    # Ensure non-empty\n    return name or 'unnamed'\n```\n\n## Test Cases\n- 'My Doc / Part 1' -\u003e 'My Doc - Part 1'\n- 'File: Important' -\u003e 'File- Important'\n- 'CON' -\u003e '_CON'\n- 'Guide.md' vs 'guide.md' -\u003e collision handled\n- Very long names -\u003e truncated with hash\n- 'naïve' (NFD) -\u003e 'naïve' (NFC)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-07T13:14:13.517995+01:00","updated_at":"2025-12-07T13:20:46.985064+01:00","dependencies":[{"issue_id":"claude-sync-8co.6","depends_on_id":"claude-sync-8co","type":"parent-child","created_at":"2025-12-07T13:14:13.518811+01:00","created_by":"jason"}]}
{"id":"claude-sync-8co.7","title":"Implement directory output structure","description":"Create the output directory structure:\n\n## Structure\n```\n\u003coutput-dir\u003e/\n├── index.json              # Manifest with sync metadata\n└── \u003cproject-slug\u003e-\u003cuuid\u003e/\n    ├── CLAUDE.md           # From prompt_template (project instructions)\n    ├── meta.json           # Full project metadata\n    └── docs/\n        ├── doc1.md\n        └── doc2.md\n```\n\n## index.json Format\n```json\n{\n  \"synced_at\": \"2025-01-15T10:30:00Z\",\n  \"org_id\": \"uuid\",\n  \"projects\": {\n    \"uuid-1\": {\n      \"name\": \"Project Name\",\n      \"slug\": \"project-name\",\n      \"path\": \"project-name-uuid/\",\n      \"updated_at\": \"...\",\n      \"docs_count\": 5\n    }\n  }\n}\n```\n\n## CLAUDE.md Generation\n- Copy prompt_template content directly\n- Add frontmatter with metadata (synced_at, source URL)\n- If no prompt_template, create minimal CLAUDE.md with project name\n\n## Overwrite Behavior\n- Overwrite existing files (MVP, no merge logic yet)\n- Create directories if they don't exist","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-07T13:14:29.001944+01:00","updated_at":"2025-12-07T13:14:29.001944+01:00","dependencies":[{"issue_id":"claude-sync-8co.7","depends_on_id":"claude-sync-8co","type":"parent-child","created_at":"2025-12-07T13:14:29.003024+01:00","created_by":"jason"}]}
{"id":"claude-sync-8co.8","title":"Add CLI interface with argparse","description":"Implement CLI interface:\n\n## Usage\n```bash\n./claude_sync.py \u003cORG_UUID\u003e                    # Sync to default location\n./claude_sync.py \u003cORG_UUID\u003e -o \u003coutput-dir\u003e    # Custom output\n./claude_sync.py \u003cORG_UUID\u003e --browser chrome   # Use Chrome cookies\n./claude_sync.py --help                        # Show help\n```\n\n## Arguments\n- org (positional, required): Organization UUID\n- -o, --output: Output directory (default: ~/.claude/synced-projects/)\n- --browser: Browser for cookies (edge/chrome/auto, default: auto)\n- --verbose: Enable debug logging\n- --dry-run: Show what would be synced without writing\n\n## ⚠️ USER FRICTION - Org UUID Discovery\n\nUsers won't know their org UUID. Need clear instructions.\n\n### How to Find Org UUID\n1. Open Claude.ai, log in\n2. Open DevTools (F12) \u003e Network tab\n3. Refresh page or click on a project\n4. Filter requests for 'organizations'\n5. Look at request URL: /api/organizations/\u003cUUID\u003e/...\n6. Copy the UUID\n\n### Alternative: Auto-Discovery (Nice to Have)\nCould fetch from /api/bootstrap endpoint which returns user's orgs.\n```python\ndef discover_org():\n    resp = fetch('/api/bootstrap')\n    orgs = resp.get('organizations', [])\n    if len(orgs) == 1:\n        return orgs[0]['uuid']\n    elif len(orgs) \u003e 1:\n        print('Multiple orgs found. Please specify:')\n        for org in orgs:\n            print(f'  {org[\"uuid\"]}: {org[\"name\"]}')\n        sys.exit(1)\n```\n\nConsider adding --discover flag or making org optional if we implement this.\n\n## Exit Codes\n- 0: Success (all projects synced)\n- 1: Partial failure (some projects failed)\n- 2: Fatal error (auth, network, etc.)\n\n## Help Text\nInclude in --help:\n- How to find org UUID\n- Default output location\n- Example usage\n- Link to README for more info","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-07T13:14:43.550462+01:00","updated_at":"2025-12-07T13:21:27.742578+01:00","dependencies":[{"issue_id":"claude-sync-8co.8","depends_on_id":"claude-sync-8co","type":"parent-child","created_at":"2025-12-07T13:14:43.551154+01:00","created_by":"jason"}]}
{"id":"claude-sync-8co.9","title":"Test with real data and sanity check","description":"Test the MVP implementation with real data:\n\n## Test Plan\n1. Run against your org with ~13 projects\n2. Verify all projects synced\n3. Check CLAUDE.md files have correct content\n4. Verify docs are readable and correctly named\n5. Check filenames for special characters handled correctly\n\n## Sanity Checks\n- [ ] All project names appear in index.json\n- [ ] CLAUDE.md matches prompt_template from web UI\n- [ ] Doc count matches what's visible in web app\n- [ ] No crashes on edge case filenames\n- [ ] Output is git-trackable (no binary artifacts)\n\n## Red Team / Edge Cases\n- Project with no prompt_template\n- Project with no docs\n- Doc with forward slash in title\n- Doc with very long name\n- Doc with unicode characters\n- Empty project\n\n## Performance Check\n- Full sync should complete in \u003c 2 minutes for ~15 projects\n- Progress bar should show meaningful updates","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-07T13:14:58.227776+01:00","updated_at":"2025-12-07T13:14:58.227776+01:00","dependencies":[{"issue_id":"claude-sync-8co.9","depends_on_id":"claude-sync-8co","type":"parent-child","created_at":"2025-12-07T13:14:58.228649+01:00","created_by":"jason"}]}
{"id":"claude-sync-bkw","title":"Incremental Sync","description":"Add incremental sync capability to only fetch changed projects/docs.\n\n## Goal\nReduce sync time from 30-60s to 2-5s for daily updates by only downloading what changed.\n\n## Efficiency Gains\n- Full sync: ~30 MB, 30-60s\n- Daily incremental: ~0.5 MB, 2-5s (97% reduction)\n\n## How It Works\n1. Store sync state (timestamps, doc hashes) in index.json\n2. On sync, fetch project list (lightweight)\n3. Compare updated_at timestamps with stored values\n4. Only download full content for changed projects\n\n## Key Limitation\nDocs don't have updated_at field - need content hashing:\n```python\nimport hashlib\ndef doc_hash(content: str) -\u003e str:\n    return hashlib.sha256(content.encode()).hexdigest()[:16]\n```\n\n## index.json Extension\n```json\n{\n  \"projects\": {\n    \"uuid-1\": {\n      \"remote_updated_at\": \"2025-01-15T10:30:00Z\",\n      \"local_synced_at\": \"2025-01-15T10:35:00Z\",\n      \"doc_hashes\": {\n        \"doc-uuid-1\": \"a1b2c3d4...\",\n        \"doc-uuid-2\": \"e5f6g7h8...\"\n      }\n    }\n  }\n}\n```\n\n## CLI\n- Default: incremental (if index.json exists)\n- --full: Force full sync (ignore cached state)\n\n## Dependencies\n- Requires MVP complete","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-07T13:15:58.592585+01:00","updated_at":"2025-12-07T13:15:58.592585+01:00","dependencies":[{"issue_id":"claude-sync-bkw","depends_on_id":"claude-sync-8co","type":"blocks","created_at":"2025-12-07T13:15:58.593873+01:00","created_by":"jason"}]}
{"id":"claude-sync-bkw.1","title":"Implement sync state storage","description":"Extend index.json to store sync state for incremental updates:\n\n## Fields to Track\n- remote_updated_at: Project's updated_at from API\n- local_synced_at: When we last synced this project\n- doc_hashes: SHA256 hashes of doc content (for change detection)\n\n## Implementation\n```python\ndef update_sync_state(index: dict, project_id: str, project_data: dict, docs: list):\n    index['projects'][project_id] = {\n        'name': project_data['name'],\n        'slug': slugify(project_data['name']),\n        'remote_updated_at': project_data['updated_at'],\n        'local_synced_at': datetime.now().isoformat(),\n        'doc_hashes': {\n            doc['uuid']: hashlib.sha256(doc['content'].encode()).hexdigest()[:16]\n            for doc in docs\n        }\n    }\n```\n\n## Backward Compatibility\n- If index.json exists but lacks sync state fields, treat as 'needs full sync'\n- Gracefully handle missing/malformed index.json","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-07T13:16:11.4343+01:00","updated_at":"2025-12-07T13:16:11.4343+01:00","dependencies":[{"issue_id":"claude-sync-bkw.1","depends_on_id":"claude-sync-bkw","type":"parent-child","created_at":"2025-12-07T13:16:11.43486+01:00","created_by":"jason"}]}
{"id":"claude-sync-bkw.2","title":"Implement change detection logic","description":"Implement logic to detect what changed since last sync:\n\n## Detection Algorithm\n```python\ndef get_changed_projects(index: dict, projects: list) -\u003e list:\n    changed = []\n    for project in projects:\n        pid = project['uuid']\n        stored = index.get('projects', {}).get(pid)\n        \n        if not stored:\n            # New project\n            changed.append((pid, 'new'))\n        elif project['updated_at'] \u003e stored['remote_updated_at']:\n            # Modified project\n            changed.append((pid, 'modified'))\n    \n    # Detect deleted projects\n    for stored_id in index.get('projects', {}).keys():\n        if not any(p['uuid'] == stored_id for p in projects):\n            changed.append((stored_id, 'deleted'))\n    \n    return changed\n```\n\n## Handling Deleted Projects\n- Option 1: Leave local files, mark as 'orphaned' in index\n- Option 2: Delete local files\n- Recommend Option 1 for safety (user can manually clean up)\n\n## Doc-Level Detection\nSince docs lack updated_at, compare hashes:\n```python\ndef docs_changed(stored_hashes: dict, new_docs: list) -\u003e bool:\n    new_hashes = {d['uuid']: doc_hash(d['content']) for d in new_docs}\n    return stored_hashes != new_hashes\n```","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-07T13:16:26.509828+01:00","updated_at":"2025-12-07T13:16:26.509828+01:00","dependencies":[{"issue_id":"claude-sync-bkw.2","depends_on_id":"claude-sync-bkw","type":"parent-child","created_at":"2025-12-07T13:16:26.510706+01:00","created_by":"jason"}]}
{"id":"claude-sync-bkw.3","title":"Add --full flag and test incremental sync","description":"Add CLI flag for full sync and test incremental behavior:\n\n## CLI Behavior\n- Default (with existing index.json): incremental sync\n- Default (no index.json): full sync\n- --full: Force full sync even if index.json exists\n\n## Test Plan\n1. Run initial sync (should be full)\n2. Wait, run again (should be incremental, fast)\n3. Modify a project in web UI\n4. Run sync, verify only that project updated\n5. Test --full flag forces complete resync\n\n## Metrics to Log\n- Projects checked: N\n- Projects changed: M\n- Time taken: Xs\n- Data transferred: X KB (estimate)\n\n## Expected Results\n- First sync: 30-60s, all projects\n- Incremental (no changes): 2-5s, project list only\n- Incremental (1 change): 5-10s, project list + 1 project","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-07T13:16:41.197278+01:00","updated_at":"2025-12-07T13:16:41.197278+01:00","dependencies":[{"issue_id":"claude-sync-bkw.3","depends_on_id":"claude-sync-bkw","type":"parent-child","created_at":"2025-12-07T13:16:41.197814+01:00","created_by":"jason"}]}
{"id":"claude-sync-zar","title":"Archive old Claude migration folder","description":"Clean up the old /Users/jason/Documents/Claude migration/ folder:\n\n## Current Contents\n- Claude-data-2025-04-03-12-15-45/ - Raw export (keep for reference)\n- old/ - Old scripts (archived to reference/)\n- process_projects.py - Old script (archived to reference/)\n- processed_projects*/ - Processed output (can delete after verifying new tool works)\n- PDF - refund email (personal, not relevant)\n- SYNC_PROJECT_PLAN.md - Moved to docs/RESEARCH.md\n\n## Actions\n1. Verify new claude-sync tool works\n2. Delete processed_projects* folders (redundant)\n3. Keep raw export in Documents for now\n4. Consider moving to archive location\n\n## Note\nDon't delete anything until MVP is working and tested!","status":"open","priority":3,"issue_type":"chore","created_at":"2025-12-07T13:17:39.190855+01:00","updated_at":"2025-12-07T13:17:39.190855+01:00"}
